[build]
  command = """
    echo "üîç Variables d'environnement Tina CMS :"
    echo "TINA_CLIENT_ID: $TINA_CLIENT_ID"
    echo "TINA_TOKEN: ${TINA_TOKEN:0:8}..."
    echo "TINA_SEARCH_TOKEN: ${TINA_SEARCH_TOKEN:0:8}..."
    
    # V√©rification de la pr√©sence des variables
    if [ -z "$TINA_CLIENT_ID" ] || [ -z "$TINA_TOKEN" ]; then
      echo "‚ùå ERREUR : Variables Tina CMS manquantes"
      exit 1
    fi
    
    npx tinacms build && npm run build
  """
  publish = "dist"

[build.environment]
  NODE_VERSION = "20.11.0"
  TINA_CLIENT_ID = "e5043161-7d23-41bf-a7bc-626eef359ef0"
  TINA_TOKEN = "abe9d5391460078be76f1935613f9055303eff11"
  TINA_SEARCH_TOKEN = "863c5906aca00d6e9a0c8b5224c0726f4cc45fdc"

# üîê Tina CMS Environment Variables
# Ensure these are also set in Netlify UI
[context.production.environment]
  TINA_CLIENT_ID = "${TINA_CLIENT_ID}"
  TINA_TOKEN = "${TINA_TOKEN}"
  TINA_SEARCH_TOKEN = "${TINA_SEARCH_TOKEN}"
