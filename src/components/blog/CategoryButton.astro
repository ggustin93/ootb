---
import { Icon } from 'astro-icon/components';

interface Props {
  href: string;
  icon: string;
  label: string;
  color?: string;
  isActive?: boolean;
  withAnchor?: boolean;
  mobileIconOnly?: boolean;
}

const { 
  href, 
  icon, 
  label, 
  color = '#1f2937', 
  isActive = false,
  withAnchor = false,
  mobileIconOnly = false
} = Astro.props;

// Ajouter l'ancre si nécessaire
const isPremium = href.includes('/premium');
const finalHref = withAnchor 
  ? isPremium 
    ? `${href}#premium-section-top` 
    : href.includes('/blog') 
      ? `${href}#blog-filters`
      : `${href}#category-filters` 
  : href;
---

<a
  href={finalHref}
  class:list={[
    'group relative inline-flex items-center gap-2',
    'transform skew-x-[-12deg]',
    'transition-all duration-300',
    'px-3 sm:px-6 py-2 sm:py-2.5',
    'ring-2',
    // Optimisation tactile pour mobile
    'min-h-[40px]',
    isActive ? [
      'scale-105 shadow-lg'
    ] : [
      'hover:-translate-y-1'
    ]
  ]}
  style={isActive 
    ? `background-color: white; color: ${color}; --hover-text-color: ${color}; --hover-ring-color: ${color}; --tw-ring-color: ${color};` 
    : `background-color: ${color}; color: white; --hover-text-color: ${color}; --hover-ring-color: ${color}; --tw-ring-color: ${color};`
  }
  aria-current={isActive ? 'page' : undefined}
>
  <span class="transform skew-x-[12deg] flex items-center gap-1.5 sm:gap-2.5">
    <Icon 
      name={icon} 
      class:list={[
        'transition-transform duration-300 group-hover:scale-110 group-hover:text-[var(--hover-text-color)]',
        mobileIconOnly ? 'w-5 h-5' : 'w-4 h-4'
      ]} 
    />
    <span 
      class:list={[
        'font-bold uppercase tracking-wide italic transition-colors duration-300 group-hover:text-[var(--hover-text-color)]',
        mobileIconOnly ? 'hidden sm:inline' : 'text-xs sm:text-sm'
      ]}
    >
      {label}
    </span>
  </span>
</a>

<style>
  /* Inversion des couleurs au survol */
  a:not(.scale-105):hover {
    background-color: white !important;
    color: var(--hover-text-color) !important;
  }

  /* Support tactile amélioré pour mobile */
  @media (max-width: 640px) {
    a {
      touch-action: manipulation;
    }
  }
</style> 