---
import { Icon } from 'astro-icon/components';
import SectionDivider from '~/components/ui/SectionDivider.astro';
import Button from '~/components/ui/Button.astro';

interface Props {
  title?: string;
  description?: string;
  placeholder?: string;
  buttonText?: string;
  badgeText?: string;
}

const {
  title = "Rejoignez notre communauté éducative",
  description = "Recevez chaque mois une sélection d'articles, de ressources et d'événements pour innover dans votre pratique",
  placeholder = "Votre adresse email",
  buttonText = "S'inscrire",
  badgeText = "Newsletter mensuelle"
} = Astro.props;

const socialLinks = [
  {
    name: 'YouTube',
    icon: 'tabler:brand-youtube',
    href: 'https://youtube.com/@outofthebooks',
    color: 'text-red-500'
  },
  {
    name: 'Spotify',
    icon: 'tabler:brand-spotify',
    href: 'https://open.spotify.com/show/outofthebooks',
    color: 'text-green-500'
  },
  {
    name: 'Facebook',
    icon: 'tabler:brand-facebook',
    href: 'https://facebook.com/outofthebooks',
    color: 'text-blue-500'
  },
  {
    name: 'LinkedIn',
    icon: 'tabler:brand-linkedin',
    href: 'https://linkedin.com/company/outofthebooks',
    color: 'text-blue-600'
  },
  {
    name: 'Instagram',
    icon: 'tabler:brand-instagram',
    href: 'https://instagram.com/outofthebooks',
    color: 'text-pink-500'
  }
];
---

<section id="rejoindre" class="relative py-24 px-4 md:px-8 mb-8">
  <!-- Livres flottants externes -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <!-- Premier livre flottant -->
    <div class="absolute z-30 w-20 h-28 -rotate-[22deg] top-[25%] left-[12%] opacity-25 transition-transform hover:-translate-y-2 duration-1000">
      <Icon name="tabler:book-2" class="w-full h-full text-[--ootb-blue] filter drop-shadow-lg" />
    </div>
    
    <!-- Deuxième livre flottant -->
    <div class="absolute z-30 w-16 h-24 rotate-[38deg] bottom-[30%] right-[8%] opacity-25 transition-transform hover:translate-y-2 duration-1000">
      <Icon name="tabler:book" class="w-full h-full text-[--ootb-turquoise] filter drop-shadow-lg" />
    </div>
  </div>

  <div class="max-w-7xl mx-auto">
    <div class="bg-white/90 backdrop-blur-xl rounded-3xl p-8 md:p-16 text-center relative overflow-hidden border border-[--ootb-turquoise]/20 hover:border-[--ootb-turquoise]/30 transition-colors duration-300">
      <div class="absolute inset-0 bg-white/90 backdrop-blur-xl rounded-3xl"></div>
      <!-- Effets décoratifs modernes et subtils -->
      <div class="absolute inset-0 bg-gradient-to-b from-transparent via-blue-50/10 to-[--ootb-turquoise]/10" />
      <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-60 bg-gradient-to-r from-blue-100/30 via-[--ootb-turquoise]/20 to-blue-100/30 blur-3xl opacity-30 rotate-12" />

      <!-- Livre flottant interne droit -->
      <div class="absolute z-30 w-14 h-20 rotate-[23deg] top-16 right-[22%] opacity-30 transition-all duration-1000 hover:rotate-[28deg] hover:-translate-y-2">
        <Icon name="tabler:book-2" class="w-full h-full text-[--ootb-turquoise] filter drop-shadow-lg" />
      </div>

      <!-- Livre flottant interne gauche -->
      <div class="absolute z-30 w-16 h-22 -rotate-[8deg] top-20 left-[18%] opacity-30 transition-all duration-1000 hover:-rotate-[12deg] hover:-translate-y-3">
        <Icon name="tabler:book" class="w-full h-full text-[--ootb-blue] filter drop-shadow-lg" />
      </div>

      <div class="relative">
        <!-- Icône et badge -->
        <div class="inline-flex flex-col items-center gap-4 mb-8">
            <div class="bg-[--ootb-blue] rounded-2xl p-4 group hover:scale-105 transition-all duration-300">
            <Icon name="tabler:mail-filled" class="w-8 h-8 text-white" />
          </div>
          <SectionDivider variant="turquoise" class="backdrop-blur-sm font-medium tracking-wide mb-2">
            <Icon name="tabler:sparkles" class="w-4 h-4 mr-1" />
            {badgeText}
          </SectionDivider>
        </div>

        <!-- Titre et description -->
        <div class="max-w-2xl mx-auto mb-8">
          <h2 class="text-3xl md:text-4xl font-display font-bold text-[--ootb-blue] mb-4">
            {title}
          </h2>
          <p class="text-lg text-gray-600">
            {description}
          </p>
        </div>

        <!-- Formulaire -->
        <form 
          class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto group mb-12" 
          action="/api/newsletter" 
          method="POST"
        >
          <div class="flex-1 relative">
            <Icon 
              name="tabler:at" 
              class="absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"
            />
            <input 
              type="email" 
              name="email"
              placeholder={placeholder}
              required
              class="w-full h-14 pl-14 pr-6 rounded-full text-base bg-white/80 backdrop-blur-sm border border-gray-200 focus:border-[--ootb-blue] focus:ring-2 focus:ring-[--ootb-blue]/20 outline-none transition-all placeholder:text-gray-400"
            />
          </div>
          <Button 
            type="submit"
            variant="primary" 
            class="h-14 px-8 rounded-full bg-[--ootb-blue] ootb-blue hover:scale-105 transition-all duration-300"
          >
            <span class="relative z-10">{buttonText}</span>
            <Icon 
              name="tabler:arrow-right" 
              class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"
            />
          </Button>
        </form>

        <!-- Réseaux sociaux -->
        <div class="border-t border-gray-100/50 pt-8">
          <h3 class="text-lg font-display font-semibold text-gray-900 mb-2">Rejoignez la conversation</h3>
          <p class="font-sans text-gray-600 text-sm mb-6">Découvrez nos contenus exclusifs sur vos réseaux préférés</p>
          
          <div class="flex justify-center flex-wrap gap-3">
            {socialLinks.map(social => (
              <a
                href={social.href}
                target="_blank"
                rel="noopener noreferrer"
                class="group flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white/80 backdrop-blur-sm hover:bg-white border border-gray-100 hover:border-gray-200 hover:-translate-y-0.5 transition-all duration-300"
                title={social.name}
              >
                <Icon 
                  name={social.icon} 
                  class={`w-5 h-5 ${social.color} transition-transform duration-300 group-hover:scale-110`}
                />
                <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900">{social.name}</span>
              </a>
            ))}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<style is:global>
  /* Police display pour les titres */
  .font-display {
    font-family: 'Plus Jakarta Sans', system-ui, sans-serif;
  }

  /* Police système optimisée pour le corps du texte */
  .font-sans {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  }

  @keyframes gentle-pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 0.5; }
  }

  .animate-gentle-pulse {
    animation: gentle-pulse 4s ease-in-out infinite;
  }
</style>

<!-- Ajout des polices -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
