---
import type { ImageMetadata } from 'astro';
import Image from '~/components/common/Image.astro';
import { Icon } from 'astro-icon/components';
import SectionDivider from './SectionDivider.astro';

interface Props {
  title: string;
  description: string;
  date: string;
  image: ImageMetadata | string;
  badge: string;
  badgeColor: 'purple' | 'blue';
  link: string;
  cols?: number;
}

const { 
  title, 
  description, 
  date,
  image,
  badge,
  badgeColor,
  link,
  cols = 1
} = Astro.props;

const badgeIcons = {
  'Festival 2025': 'tabler:confetti',
  'Live Facebook': 'tabler:brand-facebook'
};
---

<a 
  href={link}
  class:list={[
    'group relative bg-white rounded-2xl overflow-hidden transition-all duration-300',
    'hover:shadow-2xl hover:-translate-y-1',
    'min-h-[320px] flex items-stretch',
    cols === 2 ? 'md:col-span-2' : ''
  ]}
>
  <!-- Image de fond -->
  <div class="absolute inset-0 w-full h-full">
    <Image
      src={image}
      alt=""
      class="w-full h-full object-cover transition-all duration-500 scale-100 group-hover:scale-110"
      widths={[400, 900]}
      sizes="(max-width: 900px) 400px, 900px"
      aspectRatio="16:9"
      format={typeof image === 'string' ? ['webp'] : undefined}
    />
  </div>

  <!-- Gradient overlay -->
  <div class="absolute inset-0 bg-gradient-to-br from-gray-900/80 via-gray-900/50 to-gray-900/80 mix-blend-multiply transition-opacity duration-300 group-hover:opacity-75" />
  
  <div class="relative z-10 p-8 flex flex-col justify-between w-full">
    <div>
      <!-- SectionDivider -->
      <div class:list={[
        'inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium backdrop-blur-sm',
        badgeColor === 'purple' ? 'bg-purple-100/80 text-purple-700' : 'bg-sky-100/80 text-sky-700'
      ]}>
        <Icon name={badgeIcons[badge]} class="w-4 h-4" />
        {badge}
      </div>

      <!-- Title & Description -->
      <h3 class="text-2xl md:text-3xl font-bold text-white mt-6 mb-3 drop-shadow-sm">
        {title}
      </h3>
      <p class="text-gray-200 line-clamp-2 mb-6 max-w-xl drop-shadow-sm">
        {description}
      </p>
    </div>

    <div class="flex items-center justify-between">
      <!-- Date -->
      <div class="flex items-center gap-3 text-gray-200 backdrop-blur-sm bg-black/20 px-4 py-2 rounded-full">
        <Icon name="tabler:calendar-event" class="w-5 h-5" />
        <time datetime={date} class="text-sm">
          {new Date(date).toLocaleDateString('fr-FR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          })}
        </time>
      </div>

      <!-- Arrow indicator -->
      <div class="w-10 h-10 rounded-full bg-white/10 backdrop-blur-sm text-white flex items-center justify-center transform translate-x-4 opacity-0 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300">
        <Icon name="tabler:arrow-right" class="w-5 h-5" />
      </div>
    </div>
  </div>
</a> 