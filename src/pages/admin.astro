---
// Configuration Tina CMS pour Astro
const TINA_CLIENT_ID = import.meta.env.TINA_CLIENT_ID || 'default-client-id';
---

<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Administration Out of the Books</title>
    <script 
      src="https://unpkg.com/@tinacms/cli@latest/dist/tina.js" 
      crossorigin
    ></script>
  </head>
  <body class="tinacms">
    <div id="root"></div>
    <script define:vars={{TINA_CLIENT_ID}}>
      const init = async () => {
        try {
          // üöÄ Configuration Tina Cloud
          await window.tina.init({
            clientId: TINA_CLIENT_ID,
            branch: 'main',
            tokenStorage: 'LOCAL_STORAGE',
            cmsCallback: (cms) => {
              // Activation des fonctionnalit√©s admin
              cms.flags.set('tina-admin', true);
            },
            // Configuration de l'API
            apiURL: import.meta.env.DEV 
              ? 'http://localhost:4001/graphql'
              : `https://content.tinajs.io/1.5/content/${TINA_CLIENT_ID}/github/main`
          });

          console.log('‚úÖ Tina CMS initialis√© avec succ√®s');
        } catch (error) {
          console.error('‚ùå √âchec de l\'initialisation de Tina', error);
        }
      };

      init();
    </script>
  </body>
</html>
